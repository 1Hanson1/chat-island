# 删除的方法：
    UserQuotaController里面以前有个api/user/admin/vip-remove，现在移至UserAdminController的admin/user/remove-vip
# 修改的方法：
    UserQuotaController里面的api/user: 
    /renew-vip和/upgrade-vip新增了传入时间参数支持，并友好化了name传参，你可以这样做:
    ```txt
    RequestParam: ?name=xxx,
    RequestBody: {
        vipKey:$$$$$$$$$$,
        duration: any integer
    }
    ```
    也可以这样做:
    ```txt
    RequestParam: 无
    RequestBody: {
        name:xxx
        vipKey:$$$$$$$$$$,
        duration: any integer
    }
    ```
    但如果你这样做:
    ```txt
    RequestParam: ?name=xxx
    RequestBody: {
        name:yyy
        vipKey:$$$$$$$$$$,
        duration: any integer
    }
    ```
    优先使用xxx
    另外，不要向duration中传入大于10000的数字，数据库的timestamp可能会炸

# 新增的方法
## ChatAdminController API
1. 获取用户会话列表
请求方法: GET

端点: /admin/chat/sessions/get/{uid}

参数:

路径参数:

uid: 字符串，需要获取会话列表的用户唯一标识符

用途: 获取指定用户的所有聊天会话列表

响应数据:

成功:

status: 字符串，表示成功状态("success")

data: SessionStatus对象列表，包含会话详情

total: 整数，获取的会话数量

格式:

```json
{
  "status": "success",
  "data": [
    {
        "memoryId": "string",
        "messageCount": integer,
        "createdTime": 一个日期,
        "updatedTime": 一个日期,
        "name":会话名称
    },
    // 更多会话
  ],
  "total": integer
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "获取会话列表失败: <错误信息>"}

错误请求: 该端点代码中未明确定义

2. 获取会话详情
请求方法: GET

端点: /admin/chat/session/get

参数:

请求体:

uid: 字符串，用户ID

sessionId: 字符串，会话ID

用途: 获取特定用户会话的详细信息和消息历史记录

响应数据:

成功:

status: 字符串，表示成功状态("success")

data: 包含以下内容的对象:

sessionInfo: 包含会话元数据的SessionStatus对象

messages: 包含type、text和timestamp的消息对象列表

messageCount: 整数，会话中的消息数量

格式:

```json
{
  "status": "success",
  "data": {
    "sessionInfo": {
        "memoryId": "string",
        "messageCount": integer,
        "createdTime": 一个日期,
        "updatedTime": 一个日期,
        "name":会话名称
    },
    "messages": [
      {
        "type": "string",
        "text": "string",
        "timestamp": long
      },
      // 更多消息
    ],
    "messageCount": integer
  }
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果缺少uid或sessionId

{"error": "请传入uid和sessionId"}

HttpStatus.NOT_FOUND (404): 如果会话不存在

{"error": "会话不存在"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "获取会话详情失败: <错误信息>"}

错误请求含义: 当请求体中uid或sessionId为null时返回，表示输入参数不完整

3. 删除用户会话
请求方法: DELETE

端点: /admin/chat/session/delete

参数:

请求体:

uid: 字符串，用户ID

sessionId: 字符串，要删除的会话ID

用途: 删除特定用户会话及其关联消息

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("会话删除成功")

格式:

```json
{
  "status": "success",
  "message": "会话删除成功"
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果缺少uid或sessionId

{"error": "请传入uid和sessionId"}

HttpStatus.NOT_FOUND (404): 如果会话不存在

{"error": "会话不存在"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "删除会话失败: <错误信息>"}

错误请求含义: 当请求体中uid或sessionId为null时返回，表示输入参数不完整

4. 删除所有用户会话
请求方法: DELETE

端点: /admin/chat/sessions/delete/{uid}

参数:

路径参数:

uid: 字符串，要删除会话的用户ID

用途: 删除指定用户的所有聊天会话及其消息

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("用户所有会话已清空")

deletedCount: 整数，删除的会话数量

格式:

```json
{
  "status": "success",
  "message": "用户所有会话已清空",
  "deletedCount": integer
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "清空会话失败: <错误信息>"}

错误请求: 该端点代码中未明确定义

5. 获取用户聊天统计信息
请求方法: GET

端点: /admin/chat/stats/{uid}

参数:

路径参数:

uid: 字符串，要获取聊天统计信息的用户ID

用途: 获取用户聊天会话的统计信息，包括总会话数、总消息数、空会话数和最近会话

响应数据:

成功:

status: 字符串，表示成功状态("success")

data: 包含以下内容的对象:

uid: 字符串，用户ID

totalSessions: 整数，总会话数

totalMessages: 整数，最近会话中的总消息数

emptySessions: 整数，没有消息的会话数

activeSessions: 整数，有消息的会话数

recentSessions: 最近的SessionStatus对象列表(最多10个)

格式:

```json
{
  "status": "success",
  "data": {
    "uid": "string",
    "totalSessions": integer,
    "totalMessages": integer,
    "emptySessions": integer,
    "activeSessions": integer,
    "recentSessions": [
      {
        "memoryId": "string",
        "messageCount": integer,
        // 其他SessionStatus字段
      },
      // 更多会话
    ]
  }
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "获取统计信息失败: <错误信息>"}

错误请求: 该端点代码中未明确定义

6. 删除空用户会话
请求方法: DELETE

端点: /admin/chat/sessions/clear/{uid}

参数:

路径参数:

uid: 字符串，要删除空会话的用户ID

用途: 删除指定用户的所有空聊天会话(没有消息的会话)

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("空会话清理完成")

deletedCount: 整数，删除的空会话数量

格式:

```json
{
  "status": "success",
  "message": "空会话清理完成",
  "deletedCount": integer
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "清理空会话失败: <错误信息>"}

错误请求: 该端点代码中未明确定义

7. 重命名用户会话
请求方法: PUT

端点: /admin/chat/session/rename

参数:

请求体:

uid: 字符串，用户ID

sessionId: 字符串，要重命名的会话ID

newName: 字符串，会话的新名称

用途: 重命名特定用户会话

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("会话重命名成功")

格式:

```json
{
  "status": "success",
  "message": "会话重命名成功"
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果newName为null或空

{"error": "会话名称不能为空"}

HttpStatus.NOT_FOUND (404): 如果会话不存在

{"error": "会话不存在"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "重命名会话失败: <错误信息>"}

错误请求含义: 当请求体中newName为null或空时返回，表示无效的会话名称

## CsAdminController API
1. 获取客服待处理查询
请求方法: GET

端点: /admin/cs/inquiries/{cid}

参数:

路径参数:

cid: 字符串，请求待处理查询的客服用户ID

用途: 获取特定客服用户的待处理客户服务查询列表

响应数据:

成功:

status: 字符串，表示成功状态("success")

data: 包含查询详情的CsInquiry对象列表

格式:

```json
{
  "status": "success",
  "data": [
    {
      "inquiryId": "string",
      // 其他CsInquiry字段
    },
    // 更多查询
  ]
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果cid为null或空

{"error": "客服UID不能为空"}

错误请求含义: 当cid为null或空时返回，表示无效的客服用户ID

2. 完成用户问题
请求方法: POST

端点: /admin/cs/complete

参数:

请求体:

csUid: 字符串，客服用户ID(可选，默认为JWT令牌中的UID)

inquiryId: 字符串，要完成的查询ID

replyMsg: 字符串，对查询的回复消息

用途: 允许客服用户通过回复将查询标记为已完成

响应数据:

成功:

status: 字符串，表示成功状态("success")

data: 字符串，包含查询ID和客服用户名的确认信息

格式:

```json
{
  "status": "success",
  "data": "问题 <inquiryId> 已由客服 <name> 回复"
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果csUid、inquiryId或replyMsg为null或空

{"error": "客服id,查询id,客服回复至少存在一个NULL"}

HttpStatus.FORBIDDEN (403): 如果查询已被处理或不存在

{"status": "error", "data": "问题已被处理或不存在"}

错误请求含义: 当csUid、inquiryId或replyMsg为null或空时返回，表示输入参数不完整

## KnowledgeBaseAdminController API
1. 获取知识库文档
请求方法: GET

端点: /admin/knowledge/kb-docs

参数:

请求参数:

uid: 字符串，用户ID

kid: 字符串，知识库ID

用途: 从指定用户的知识库中获取所有文档信息

响应数据:

成功:

status: 字符串，表示成功状态("success")

data: 包含以下内容的对象:

uid: 字符串，用户ID

kid: 字符串，知识库ID

knowledgeBaseName: 字符串，知识库名称

documents: 文档元数据列表

格式:

```json
{
  "status": "success",
  "data": {
    "uid": "string",
    "kid": "string",
    "knowledgeBaseName": "string",
    "documents": [
      {
        "docId": "string",
        "originalFilename": "string",
        "fileType": "string",
        "fileSize": integer,
        "segmentCount": integer,
        "uploadTime": timestamp,
        "status": active or deleted
      },
      // 更多文档
    ]
  }
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果获取文档时发生错误

{"error": "获取知识库文档失败: <错误信息>"}

错误请求含义: 在文档检索过程中发生异常时返回，通常由于无效的uid或kid或数据库问题

2. 获取用户知识库
请求方法: GET

端点: /admin/knowledge/user-kbs

参数:

请求参数:

uid: 字符串，用户ID

用途: 获取指定用户的所有知识库及其文档

响应数据:

成功:

status: 字符串，表示成功状态("success")

data: 包含以下内容的对象:

uid: 字符串，用户ID

knowledgeBases: 知识库ID到文档元数据列表的映射

格式:

```json
{
  "status": "success",
  "data": {
    "uid": "string",
    "knowledgeBases": {
      "<kid>": [
        {
          "docId": "string",
          "originalFilename": "string",
          "fileType": "string",
          "fileSize": integer,
          "segmentCount": integer,
          "uploadTime": timestamp,
          "status": active or deleted
        },
        // 更多文档
      ],
      // 更多知识库
    }
  }
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果获取知识库时发生错误

{"error": "获取用户知识库失败: <错误信息>"}

错误请求含义: 在知识库检索过程中发生异常时返回，通常由于无效的uid或数据库问题

3. 批量获取用户知识库
请求方法: GET

端点: /admin/knowledge/batch-users

参数:

请求参数:

ids: 字符串列表，用户ID列表

用途: 在单个请求中获取多个用户的知识库信息

响应数据:

成功:

status: 字符串，表示成功状态("success")

data: 用户ID到知识库ID到文档元数据列表映射的映射

格式:

```json
{
  "status": "success",
  "data": {
    "<uid>": {
      "<kid>": [
        {
          "docId": "string",
          "originalFilename": "string",
          "fileType": "string",
          "fileSize": integer,
          "segmentCount": integer,
          "uploadTime": timestamp,
          "status": active or deleted
        },
        // 更多文档
      ],
      // 更多知识库
    },
    // 更多用户
  }
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果对任何用户发生错误

{"error": "批量获取用户知识库失败: <错误信息>"}

错误请求含义: 在批量检索过程中发生异常时返回，通常由于任何用户的无效用户ID或数据库问题

4. 删除所有用户知识库
请求方法: DELETE

端点: /admin/knowledge/delete-all-user-kbs

参数:

请求参数:

uid: 字符串，要删除知识库的用户ID

用途: 删除指定用户的所有知识库

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("用户所有知识库删除成功")

uid: 字符串，用户ID

格式:

```json
{
  "status": "success",
  "message": "用户所有知识库删除成功",
  "uid": "string"
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果删除过程中发生错误

{"error": "删除用户所有知识库失败: <错误信息>"}

错误请求含义: 在删除过程中发生异常时返回，通常由于无效的uid或数据库问题

5. 删除用户知识库
请求方法: DELETE

端点: /admin/knowledge/delete-user-kb

参数:

请求参数:

uid: 字符串，用户ID

kid: 字符串，要删除的知识库ID

用途: 删除用户的特定知识库

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("知识库删除成功")

uid: 字符串，用户ID

kid: 字符串，知识库ID

格式:

```json
{
  "status": "success",
  "message": "知识库删除成功",
  "uid": "string",
  "kid": "string"
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果删除过程中发生错误

{"error": "删除知识库失败: <错误信息>"}

错误请求含义: 在删除过程中发生异常时返回，通常由于无效的uid或kid或数据库问题

6. 清空知识库文档
请求方法: DELETE

端点: /admin/knowledge/clear-kb-docs

参数:

请求参数:

uid: 字符串，用户ID

kid: 字符串，要清空文档的知识库ID

用途: 清空特定知识库中的所有文档而不删除知识库本身

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("知识库文档清空成功")

uid: 字符串，用户ID

kid: 字符串，知识库ID

deletedDocuments: 整数，删除的文档数量

格式:

```json
{
  "status": "success",
  "message": "知识库文档清空成功",
  "uid": "string",
  "kid": "string",
  "deletedDocuments": integer
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果清空过程中发生错误

{"error": "清空知识库文档失败: <错误信息>"}

错误请求含义: 在文档清空过程中发生异常时返回，通常由于无效的uid或kid或数据库问题

7. 删除用户文档
请求方法: DELETE

端点: /admin/knowledge/delete-user-doc

参数:

请求参数:

uid: 字符串，用户ID

docId: 字符串，要删除的文档ID

用途: 从用户知识库中删除特定文档

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("文档删除成功")

uid: 字符串，用户ID

docId: 字符串，文档ID

格式:

```json
{
  "status": "success",
  "message": "文档删除成功",
  "uid": "string",
  "docId": "string"
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果删除过程中发生错误

{"error": "删除文档失败: <错误信息>"}

错误请求含义: 在文档删除过程中发生异常时返回，通常由于无效的uid或docId或数据库问题

8. 创建用户知识库
请求方法: POST

端点: /admin/knowledge/create-user-kb

参数:

请求体:

uid: 字符串，用户ID

name: 字符串，新知识库的名称

tags: 字符串列表，知识库的可选标签(默认:空列表)

description: 字符串，知识库的可选描述

用途: 为用户创建新知识库

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("知识库创建成功")

data: 包含以下内容的对象:

uid: 字符串，用户ID

kid: 字符串，知识库ID

name: 字符串，知识库名称

tags: 字符串列表，与知识库关联的标签

description: 字符串，描述(如果未提供则为空)

createdTime: 时间戳，知识库创建时间

格式:

```json
{
  "status": "success",
  "message": "知识库创建成功",
  "data": {
    "uid": "string",
    "kid": "string",
    "name": "string",
    "tags": ["string"],
    "description": "string",
    "createdTime": "timestamp"
  }
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果uid或name为null或空

{"error": "用户ID不能为空"} 或 {"error": "知识库名称不能为空"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "创建知识库失败: <错误信息>"}

错误请求含义:

当uid为null或空时返回: {"error": "用户ID不能为空"}

当name为null或空时返回: {"error": "知识库名称不能为空"}

9. 上传用户文档
请求方法: POST

端点: /admin/knowledge/upload-user-doc

参数:

请求参数:

uid: 字符串，用户ID

kid: 字符串，知识库ID

请求部分:

file: MultipartFile，要上传的文档文件

用途: 将文档上传到用户的特定知识库，处理它并使用嵌入存储

响应数据:

成功:

status: 字符串，表示成功状态("success")

message: 字符串，确认信息("文档上传成功")

data: 包含以下内容的对象:

uid: 字符串，用户ID

kid: 字符串，知识库ID

docId: 字符串，文档ID

filename: 字符串，上传文件的名称

segments: 整数，创建的文本段数

fileSize: 长整型，文件大小(字节)

格式:

```json
{
  "status": "success",
  "message": "文档上传成功",
  "data": {
    "uid": "string",
    "kid": "string",
    "docId": "string",
    "filename": "string",
    "segments": integer,
    "fileSize": long
  }
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果知识库不存在

{"error": "知识库不存在"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误(例如文件处理失败)

{"error": "文档上传失败: <错误信息>"}

错误请求含义: 当uid和kid指定的知识库不存在时返回

## UserAdminController API
1. 获取所有用户
请求方法: GET

端点: /admin/user/users

参数:

请求参数:

category: 字符串，要过滤的用户类别(默认: "NORMAL")

用途: 按类别检索过滤后的用户列表

响应数据:

成功:

users: User对象列表(出于安全考虑密码已移除)

category: 字符串，过滤的类别

total: 整数，检索到的用户数

格式:

```json
{
  "users": [
    {
      "uid": "string",
      "name": "string",
      "category": "string",
      "createTime": "timestamp",
      "password": null
    },
    // 更多用户
  ],
  "category": "string",
  "total": integer
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果类别无效

{"error": "无效的用户类别"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "获取用户列表时发生错误"}

错误请求含义: 当category参数不是有效的User.Category枚举值时返回

2. 按名称获取用户详情
请求方法: GET

端点: /admin/user/user/{username}

参数:

路径参数:

username: 字符串，用户的用户名

用途: 通过用户名检索用户的详细信息，包括配额使用情况和VIP历史记录

响应数据:

成功:

user: User对象(密码已移除)

userInfo: 包含配额详情的UserInfoDTO对象

vipHistory: VipChangeRecord对象列表

格式:

```json
{
  "user": {
    "uid": "string",
    "name": "string",
    "category": "string",
    "createTime": "timestamp"
    // 其他User字段，密码为null
  },
  "userInfo": {
    "dailyLimit": integer,
    "usedToday": integer,
    "remainingUsage": integer,
    "vipEndTime": "timestamp"
  },
  "vipHistory": [
    {
      // VipChangeRecord字段
    },
    // 更多记录
  ]
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.NOT_FOUND (404): 如果用户未找到

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "获取用户信息时发生错误"}

错误请求: 该端点代码中未明确定义

3. 按ID获取用户详情
请求方法: GET

端点: /admin/user/user/{uid}

参数:

路径参数:

uid: 字符串，用户ID

用途: 通过用户ID检索用户的详细信息，包括配额使用情况和VIP历史记录

响应数据:

成功:

同按名称获取用户详情

错误:

同按名称获取用户详情

错误请求: 该端点代码中未明确定义

4. 创建用户
请求方法: POST

端点: /admin/user/user/add

参数:

请求体:

name: 字符串，新用户的用户名

password: 字符串，新用户的密码

category: 字符串，用户类别(可选，默认: "NORMAL")

用途: 使用指定的凭据和类别创建新用户

响应数据:

成功:

返回创建的User对象(密码已移除)

格式:

```json
{
  "uid": "string",
  "name": "string",
  "category": "string",
  "createTime": "timestamp"
  // 其他User字段，密码为null
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果name或password为null或空，或用户名已存在，或类别无效

{"error": "用户名和密码不能为空"}

{"error": "用户名已存在"}

{"error": "无效的用户类别"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "创建用户时发生错误"}

错误请求含义:

当name或password为null或空时返回: {"error": "用户名和密码不能为空"}

当用户名已存在时返回: {"error": "用户名已存在"}

当category无效时返回: {"error": "无效的用户类别"}

5. 更新用户
请求方法: PUT

端点: /admin/user/user/{username}

参数:

路径参数:

username: 字符串，要更新的用户的用户名

请求体:

name: 字符串，可选的新用户名

password: 字符串，可选的新密码

category: 字符串，可选的新类别("NORMAL"或"VIP")

reason: 字符串，类别更改的可选原因

用途: 更新用户的信息(名称、密码或类别)

响应数据:

成功:

message: 字符串，确认信息("用户信息更新成功")

user: 更新后的User对象(密码已移除)

格式:

```json
{
  "message": "用户信息更新成功",
  "user": {
    "uid": "string",
    "name": "string",
    "category": "string",
    "createTime": "timestamp"
    // 其他User字段，密码为null
  }
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果新用户名已存在或类别无效(不是"NORMAL"或"VIP")

{"error": "新用户名已存在"}

{"error": "你只能升级或降级VIP,不能修改ADMIN或CS"}

HttpStatus.NOT_FOUND (404): 如果用户未找到

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "更新用户失败"}

错误请求含义:

当新用户名已存在时返回: {"error": "新用户名已存在"}

当category不是"NORMAL"或"VIP"时返回: {"error": "你只能升级或降级VIP,不能修改ADMIN或CS"}

6. 删除用户
请求方法: DELETE

端点: /admin/user/user/{username}

参数:

路径参数:

username: 字符串，要删除的用户的用户名

用途: 从系统中删除用户

响应数据:

成功:

message: 字符串，确认信息("用户删除成功")

格式:

```json
{
  "message": "用户删除成功"
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.BAD_REQUEST (400): 如果尝试删除管理员账户

{"error": "不能删除管理员账户"}

HttpStatus.NOT_FOUND (404): 如果用户未找到

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "删除用户失败"}

错误请求含义: 当尝试删除ADMIN类别的用户时返回: {"error": "不能删除管理员账户"}

7. 获取用户调用记录
请求方法: GET

端点: /admin/user/user/{username}/invocations

参数:

路径参数:

username: 字符串，用户的用户名

请求参数:

offset: 整数，分页的起始点(默认: 0)

limit: 整数，要返回的最大记录数(默认: 50)

用途: 使用分页检索用户的模型调用记录

响应数据:

成功:

username: 字符串，用户名

records: ModelInvocationRecord对象列表

offset: 整数，分页偏移量

limit: 整数，分页限制

count: 整数，返回的记录数

格式:

```json
{
  "username": "string",
  "records": [
    {
        "id":long,
        "uid":"string",
        "content":"string",
        "modelName":"string",
        "invocationTime":日期,
        "tokensUsed":integer,
        "success":boolean
    },
    // 更多记录
  ],
  "offset": integer,
  "limit": integer,
  "count": integer
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.NOT_FOUND (404): 如果用户未找到

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "获取调用记录时发生错误"}

错误请求: 该端点代码中未明确定义

8. 获取系统统计信息
请求方法: GET

端点: /admin/user/statistics

参数:

用途: 检索系统范围的统计信息，包括按类别划分的用户数和活跃VIP记录数

响应数据:

成功:

normalUserCount: 整数，普通用户数

vipUserCount: 整数，VIP用户数

csUserCount: 整数，客服用户数

adminUserCount: 整数，管理员用户数

totalUserCount: 整数，用户总数

activeVipRecordCount: 整数，活跃VIP记录数

格式:

```json
{
  "normalUserCount": integer,
  "vipUserCount": integer,
  "csUserCount": integer,
  "adminUserCount": integer,
  "totalUserCount": integer,
  "activeVipRecordCount": integer
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限

{"error": "需要管理员权限"}

HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误

{"error": "获取统计信息时发生错误"}

错误请求: 该端点代码中未明确定义

9. 触发VIP状态检查
请求方法: POST

端点: /admin/user/vip-status-check

用途: 手动触发系统范围内的VIP状态检查和更新

响应数据:

成功:

message: 字符串，确认信息("VIP状态检查已完成")

timestamp: 时间戳，执行检查的时间

格式:

```json
{
  "message": "VIP状态检查已完成",
  "timestamp": "timestamp"
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限
```json
{"error": "需要管理员权限"}
```
HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误
```json
{"error": "VIP状态检查时发生错误"}
```
错误请求: 该端点代码中未明确定义

10. 获取配额摘要
请求方法: GET

端点: /admin/user/quota-summary

参数:

请求参数:

category: 字符串，要过滤的用户类别(默认: "NORMAL")

用途: 检索指定类别用户的配额使用摘要

响应数据:

成功:

category: 字符串，过滤的类别

quotaSummary: 用户配额摘要列表，每个包含:

uid: 字符串，用户ID

name: 字符串，用户名

category: 字符串，用户类别

createTime: 时间戳，用户创建时间

dailyLimit: 整数，每日使用限制

usedToday: 整数，今日使用量

remainingUsage: 整数，剩余使用量

vipEndTime: 时间戳，VIP过期时间

total: 整数，摘要中的用户数

格式:

```json
{
  "category": "string",
  "quotaSummary": [
    {
      "uid": "string",
      "name": "string",
      "category": "string",
      "createTime": "timestamp",
      "dailyLimit": integer,
      "usedToday": integer,
      "remainingUsage": integer,
      "vipEndTime": "timestamp"
    },
    // 更多摘要
  ],
  "total": integer
}
```
错误:

HttpStatus.FORBIDDEN (403): 如果请求者没有管理员权限
```json
{"error": "需要管理员权限"}
```
HttpStatus.BAD_REQUEST (400): 如果类别无效
```json
{"error": "无效的用户类别"}
```
HttpStatus.INTERNAL_SERVER_ERROR (500): 如果发生意外错误
```json
{"error": "获取配额摘要时发生错误"}
```
错误请求含义: 当category参数不是有效的User.Category枚举值时返回
